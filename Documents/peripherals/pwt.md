# PWT in Chip Support Library for NXP KinetisKEA series MCUs

#### 概述

KinetisKEA系列微处理器提供一个独立的PWT定时器以供测量输入的脉冲宽度

此定时器可选的时钟源共有四种，其中在使用TCLK，即外部备选时钟时，要注意不得超过总线时钟的1/4，以便满足奈奎斯特采样定律进行时钟同步

此定时器可以输入的最大脉冲频率为所选时钟源分频后频率的1/2

此定时器内部连接到`ACMPx`和`UARTx_Rx`，可由此内部连接实现其他功能

#### PWT采样

PWT共有四种采样模式，可以单独测量正脉宽和负脉宽，测量结果由自由计数器上载至脉宽寄存器位

关于这四种采样模式的详细信息，请参考KEA128参考手册

获得正负脉宽后，记正脉宽为`ppw`，负脉宽为`npw`，则被测量信号的频率为`f  = ClockSource / (ppw+npw+1)`，占空比为`Duty Cycle = ppw / (ppw+npw+1)`，其中占空比的解算仅适用于PWT采样模式2和3

注意，若无信号接入但是PWT被激活，可能会引起PWT溢出，若溢出中断使能则会产生硬件中断

在使用PWT时，若时钟源和待测信号的比值越大，则测量结果越精确，经验证，此比例大于等于4:1时，测量结果都是精确的，不需要额外校对

#### 编程模型

初始化和其他外设类似，此处不多赘述

该模块同样支持polling & IT工作模式，用户可以仿照例程中给出的方法，使用中断或者轮询模式进行脉宽测量

此外，PWT支持软复位，CSL中也提供函数支持此操作

其他细节见例程



Copyright &copy; Yangtze University EE Stark Zhang, All Rights Reserved 12.28.2017

Copyright &copy; 长江大学 电子信息学院 张璞 保留所有权利  2017.12.28